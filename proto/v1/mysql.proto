syntax = 'proto3';

package ultra.container.v1.mysql;

import "container/proto/v1/structures.proto";

service MysqlService {

    rpc createDb (CreateDbRequest) returns (CreateDbResponse) {
    }
    rpc deleteDb (DeleteDbRequest) returns (DeleteDbResponse) {
    }
    rpc commentDb (CommentDbRequest) returns (CommentDbResponse) {
    }
    rpc addAccess (AddAccessRequest) returns (AddAccessResponse) {
    }
    rpc changeAccessPassword (ChangeAccessPasswordRequest) returns (ChangeAccessPasswordResponse) {
    }
    rpc deleteAccess (DeleteAccessRequest) returns (DeleteAccessResponse) {
    }


}

message CreateDbRequest {
    string name = 1;
    string password = 2;
    string host = 3;
    uint64 container_id = 4;
}

message CreateDbResponse {
    oneof result {
        structures.DatabaseInfo info = 1;
        Error error = 2;
    }

    message Error {
        Code code = 1;
        string message = 2;

        enum Code {
            INTERNAL_ERROR = 0;
            VALIDATION_ERROR = 1;
            NOT_FOUND_ERROR = 2;
        }
    }
}

message DeleteDbRequest {
    string name = 1;
    uint64 container_id = 2;
}

message DeleteDbResponse {
    oneof result {
        string name = 1;
        Error error = 2;
    }

    message Error {
        Code code = 1;
        string message = 2;

        enum Code {
            INTERNAL_ERROR = 0;
            NOT_FOUND_ERROR = 1;
        }
    }
}

message CommentDbRequest {
    string name = 1;
    string comment = 2;
    uint64 container_id = 3;
}

message CommentDbResponse {
    oneof result {
        structures.DatabaseInfo info = 1;
        Error error = 2;
    }

    message Error {
        Code code = 1;
        string message = 2;

        enum Code {
            INTERNAL_ERROR = 0;
            NOT_FOUND_ERROR = 2;
        }
    }
}

message AddAccessRequest {
    string name = 1;
    string comment = 2;
    uint64 container_id = 3;
}

message AddAccessResponse {
    oneof result {
        structures.DatabaseInfo info = 1;
        Error error = 2;
    }

    message Error {
        Code code = 1;
        string message = 2;

        enum Code {
            INTERNAL_ERROR = 0;
            NOT_FOUND_ERROR = 1;
        }
    }
}

message ChangeAccessPasswordRequest {
    string username = 1;
    string host = 2;
    string password = 3;
    uint64 container_id = 4;
}

message ChangeAccessPasswordResponse {
    oneof result {
        structures.DatabaseInfo info = 1;
        Error error = 2;
    }

    message Error {
        Code code = 1;
        string message = 2;

        enum Code {
            INTERNAL_ERROR = 0;
            NOT_FOUND_ERROR = 1;
        }
    }
}

message DeleteAccessRequest {
    string username = 1;
    string host = 2;
    uint64 container_id = 3;
}

message DeleteAccessResponse {
    oneof result {
        structures.DatabaseInfo info = 1;
        Error error = 2;
    }

    message Error {
        Code code = 1;
        string message = 2;

        enum Code {
            INTERNAL_ERROR = 0;
            NOT_FOUND_ERROR = 1;
        }
    }
}